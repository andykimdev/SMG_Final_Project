/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:142: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  numeric_data[col].fillna(median_val, inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:142: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  numeric_data[col].fillna(median_val, inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:142: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  numeric_data[col].fillna(median_val, inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/Survival Classifier/survival_classifier/data/dataset.py:152: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  categorical_data[col].fillna('Unknown', inplace=True)
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
================================================================================
GRAPH TRANSFORMER HYPERPARAMETER OPTIMIZATION
================================================================================
Device: mps
Output: outputs/optimization
Start time: 2025-12-03 09:36:28

Loading data...
Loaded STRING prior: 198 proteins, 1184 edges
Computed diffusion kernel and 16 positional encodings
Loading data from ../processed_datasets/tcga_pancan_rppa_compiled.csv...
Loaded 7523 samples with 223 columns

Column type identification:
  Identifiers: 2
  Proteins: 198
  Clinical (numeric): 1
  Clinical (categorical): 6
  Genomic: 4
  Survival (targets): 9
  Excluded: 4

================================================================================
Filtering Samples
================================================================================
Protein filter: 7523/7523 samples have ≤50.0% missing proteins
Survival filter: 7201/7523 samples have valid DSS data
Combined: 7201/7523 samples pass all filters

================================================================================
Processing Survival Labels
================================================================================
Survival statistics:
  Events (deaths): 1601 (22.2%)
  Censored: 5600 (77.8%)
  Median survival time: 24.3 months
  Time range: 0.0 - 369.9 months

Survival by cancer type:
  ACC: n=45, events=13 (28.9%), median_time=44.4 months
  BLCA: n=328, events=104 (31.7%), median_time=17.7 months
  BRCA: n=857, events=66 (7.7%), median_time=25.9 months
  CESC: n=163, events=19 (11.7%), median_time=20.4 months
  CHOL: n=29, events=13 (44.8%), median_time=21.0 months
  COAD: n=330, events=45 (13.6%), median_time=21.1 months
  DLBC: n=33, events=2 (6.1%), median_time=24.6 months
  ESCA: n=123, events=24 (19.5%), median_time=12.9 months
  GBM: n=215, events=152 (70.7%), median_time=12.1 months
  HNSC: n=194, events=73 (37.6%), median_time=23.4 months
  KICH: n=62, events=6 (9.7%), median_time=85.7 months
  KIRC: n=446, events=102 (22.9%), median_time=38.7 months
  KIRP: n=206, events=22 (10.7%), median_time=25.0 months
  LGG: n=420, events=89 (21.2%), median_time=20.3 months
  LIHC: n=172, events=53 (30.8%), median_time=17.8 months
  LUAD: n=319, events=79 (24.8%), median_time=23.0 months
  LUSC: n=285, events=60 (21.1%), median_time=23.0 months
  MESO: n=46, events=34 (73.9%), median_time=17.0 months
  OV: n=385, events=210 (54.5%), median_time=33.1 months
  PAAD: n=115, events=56 (48.7%), median_time=15.3 months
  PCPG: n=79, events=1 (1.3%), median_time=26.9 months
  PRAD: n=349, events=4 (1.1%), median_time=32.3 months
  READ: n=111, events=12 (10.8%), median_time=20.0 months
  SARC: n=213, events=66 (31.0%), median_time=30.3 months
  SKCM: n=315, events=132 (41.9%), median_time=33.7 months
  STAD: n=326, events=75 (23.0%), median_time=14.1 months
  TGCT: n=104, events=3 (2.9%), median_time=45.3 months
  THCA: n=363, events=7 (1.9%), median_time=32.3 months
  THYM: n=89, events=3 (3.4%), median_time=34.7 months
  UCEC: n=421, events=46 (10.9%), median_time=28.9 months
  UCS: n=46, events=28 (60.9%), median_time=20.0 months
  UVM: n=12, events=2 (16.7%), median_time=23.5 months

================================================================================
Splitting Data
================================================================================
Data splits:
  Train: 5761 samples (80.0%), 1281 events
  Val:   720 samples (10.0%), 160 events
  Test:  720 samples (10.0%), 160 events

================================================================================
Processing Protein Expression Data
================================================================================
Protein features: 198

================================================================================
Processing Clinical Features
================================================================================
Clinical features: 7

================================================================================
Processing Genomic Features
================================================================================
Genomic features: 4

================================================================================
Preprocessing Complete
================================================================================
Total features per sample:
  Proteins: 198
  Clinical: 7
  Genomic:  4
  TOTAL:    209

Survival task: Predict DSS_STATUS and DSS_MONTHS
  Event rate: 22.2%
  Median follow-up: 24.3 months

Testing 8 configurations

################################################################################
# Configuration 1/8
################################################################################

================================================================================
Training: v1_baseline
================================================================================
Config: {
  "name": "v1_baseline",
  "embedding_dim": 160,
  "n_layers": 5,
  "n_heads": 8,
  "dropout": 0.45,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

Model parameters: 1,674,889
Epoch   1: Train Loss=3.7351 | Val Loss=3.3026, C-idx=0.6676
  ✓ New best validation C-index: 0.6676
Epoch   2: Train Loss=3.3706 | Val Loss=3.1900, C-idx=0.6867
  ✓ New best validation C-index: 0.6867
Epoch   3: Train Loss=3.2723 | Val Loss=3.1342, C-idx=0.7214
  ✓ New best validation C-index: 0.7214
Epoch   4: Train Loss=3.2284 | Val Loss=3.1524, C-idx=0.7285
  ✓ New best validation C-index: 0.7285
Epoch   5: Train Loss=3.1915 | Val Loss=3.0966, C-idx=0.7472
  ✓ New best validation C-index: 0.7472
Epoch   6: Train Loss=3.1491 | Val Loss=3.1090, C-idx=0.7412
Epoch   7: Train Loss=3.1146 | Val Loss=3.0840, C-idx=0.7519
  ✓ New best validation C-index: 0.7519
Epoch   8: Train Loss=3.1142 | Val Loss=3.0409, C-idx=0.7596
  ✓ New best validation C-index: 0.7596
Epoch   9: Train Loss=3.1017 | Val Loss=3.0383, C-idx=0.7685
  ✓ New best validation C-index: 0.7685
Epoch  10: Train Loss=3.0916 | Val Loss=3.0095, C-idx=0.7684
Epoch  11: Train Loss=3.0858 | Val Loss=3.0622, C-idx=0.7646
Epoch  12: Train Loss=3.0566 | Val Loss=3.0435, C-idx=0.7692
  ✓ New best validation C-index: 0.7692
Epoch  13: Train Loss=3.0463 | Val Loss=3.0441, C-idx=0.7778
  ✓ New best validation C-index: 0.7778
Epoch  14: Train Loss=3.0236 | Val Loss=3.0024, C-idx=0.7755
Epoch  15: Train Loss=2.9977 | Val Loss=3.0200, C-idx=0.7761
Epoch  16: Train Loss=3.0008 | Val Loss=2.9686, C-idx=0.7830
  ✓ New best validation C-index: 0.7830
Epoch  17: Train Loss=2.9468 | Val Loss=2.9943, C-idx=0.7726
Epoch  18: Train Loss=2.9563 | Val Loss=2.9608, C-idx=0.7821
Epoch  19: Train Loss=2.9346 | Val Loss=3.0162, C-idx=0.7792
Epoch  20: Train Loss=2.9173 | Val Loss=2.9824, C-idx=0.7698
Epoch  21: Train Loss=2.8980 | Val Loss=3.0383, C-idx=0.7707
Epoch  22: Train Loss=2.8728 | Val Loss=2.9688, C-idx=0.7804
Epoch  23: Train Loss=2.8335 | Val Loss=3.0169, C-idx=0.7735
Epoch  24: Train Loss=2.8135 | Val Loss=2.9945, C-idx=0.7800
Epoch  25: Train Loss=2.7849 | Val Loss=2.9974, C-idx=0.7737
Epoch  26: Train Loss=2.7826 | Val Loss=3.0182, C-idx=0.7727

Early stopping at epoch 26

================================================================================
RESULTS: v1_baseline
================================================================================
Best Val C-index:  0.7830
Test C-index:      0.7367
Test Loss:         3.0067

################################################################################
# Configuration 2/8
################################################################################

================================================================================
Training: v2_deeper
================================================================================
Config: {
  "name": "v2_deeper",
  "embedding_dim": 128,
  "n_layers": 8,
  "n_heads": 8,
  "dropout": 0.5,
  "learning_rate": 0.0002,
  "weight_decay": 0.0005
}

Model parameters: 1,937,801
Epoch   1: Train Loss=3.8840 | Val Loss=3.3475, C-idx=0.6265
  ✓ New best validation C-index: 0.6265
Epoch   2: Train Loss=3.4716 | Val Loss=3.3473, C-idx=0.6062
Epoch   3: Train Loss=3.4155 | Val Loss=3.3468, C-idx=0.6542
  ✓ New best validation C-index: 0.6542
Epoch   4: Train Loss=3.3814 | Val Loss=3.3316, C-idx=0.6656
  ✓ New best validation C-index: 0.6656
Epoch   5: Train Loss=3.3180 | Val Loss=3.2292, C-idx=0.6828
  ✓ New best validation C-index: 0.6828
Epoch   6: Train Loss=3.2525 | Val Loss=3.2108, C-idx=0.6934
  ✓ New best validation C-index: 0.6934
Epoch   7: Train Loss=3.2460 | Val Loss=3.1425, C-idx=0.7220
  ✓ New best validation C-index: 0.7220
Epoch   8: Train Loss=3.1913 | Val Loss=3.1522, C-idx=0.7244
  ✓ New best validation C-index: 0.7244
Epoch   9: Train Loss=3.1583 | Val Loss=3.1106, C-idx=0.7459
  ✓ New best validation C-index: 0.7459
Epoch  10: Train Loss=3.1014 | Val Loss=3.2099, C-idx=0.7338
Epoch  11: Train Loss=3.0895 | Val Loss=3.1123, C-idx=0.7561
  ✓ New best validation C-index: 0.7561
Epoch  12: Train Loss=3.0885 | Val Loss=3.0811, C-idx=0.7580
  ✓ New best validation C-index: 0.7580
Epoch  13: Train Loss=3.0643 | Val Loss=3.2099, C-idx=0.7461
Epoch  14: Train Loss=3.0062 | Val Loss=3.1416, C-idx=0.7536
Epoch  15: Train Loss=3.0124 | Val Loss=3.1498, C-idx=0.7430
Epoch  16: Train Loss=3.0064 | Val Loss=3.2326, C-idx=0.7397
Epoch  17: Train Loss=2.9772 | Val Loss=3.1492, C-idx=0.7574
Epoch  18: Train Loss=2.9710 | Val Loss=3.2327, C-idx=0.7409
Epoch  19: Train Loss=2.9211 | Val Loss=3.2722, C-idx=0.7493
Epoch  20: Train Loss=2.9372 | Val Loss=3.2794, C-idx=0.7396
Epoch  21: Train Loss=2.9323 | Val Loss=3.2575, C-idx=0.7519
Epoch  22: Train Loss=2.8797 | Val Loss=3.3169, C-idx=0.7474

Early stopping at epoch 22

================================================================================
RESULTS: v2_deeper
================================================================================
Best Val C-index:  0.7580
Test C-index:      0.7292
Test Loss:         2.9780

################################################################################
# Configuration 3/8
################################################################################

================================================================================
Training: v3_wider
================================================================================
Config: {
  "name": "v3_wider",
  "embedding_dim": 256,
  "n_layers": 4,
  "n_heads": 8,
  "dropout": 0.45,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

Model parameters: 2,662,665
Epoch   1: Train Loss=3.5784 | Val Loss=3.2543, C-idx=0.6707
  ✓ New best validation C-index: 0.6707
Epoch   2: Train Loss=3.3053 | Val Loss=3.1578, C-idx=0.7189
  ✓ New best validation C-index: 0.7189
Epoch   3: Train Loss=3.2267 | Val Loss=3.1368, C-idx=0.7284
  ✓ New best validation C-index: 0.7284
Epoch   4: Train Loss=3.1744 | Val Loss=3.1581, C-idx=0.7331
  ✓ New best validation C-index: 0.7331
Epoch   5: Train Loss=3.1285 | Val Loss=3.0933, C-idx=0.7613
  ✓ New best validation C-index: 0.7613
Epoch   6: Train Loss=3.1143 | Val Loss=3.1123, C-idx=0.7640
  ✓ New best validation C-index: 0.7640
Epoch   7: Train Loss=3.0631 | Val Loss=3.0641, C-idx=0.7613
Epoch   8: Train Loss=3.0861 | Val Loss=3.0496, C-idx=0.7716
  ✓ New best validation C-index: 0.7716
Epoch   9: Train Loss=3.0936 | Val Loss=3.0871, C-idx=0.7701
Epoch  10: Train Loss=3.0203 | Val Loss=3.0165, C-idx=0.7698
Epoch  11: Train Loss=3.0556 | Val Loss=3.0374, C-idx=0.7767
  ✓ New best validation C-index: 0.7767
Epoch  12: Train Loss=3.0262 | Val Loss=3.0193, C-idx=0.7741
Epoch  13: Train Loss=3.0065 | Val Loss=3.0077, C-idx=0.7764
Epoch  14: Train Loss=2.9733 | Val Loss=2.9931, C-idx=0.7817
  ✓ New best validation C-index: 0.7817
Epoch  15: Train Loss=2.9659 | Val Loss=3.0174, C-idx=0.7775
Epoch  16: Train Loss=2.9597 | Val Loss=2.9998, C-idx=0.7866
  ✓ New best validation C-index: 0.7866
Epoch  17: Train Loss=2.9408 | Val Loss=2.9979, C-idx=0.7760
Epoch  18: Train Loss=2.9388 | Val Loss=2.9963, C-idx=0.7692
Epoch  19: Train Loss=2.9187 | Val Loss=2.9282, C-idx=0.7840
Epoch  20: Train Loss=2.8961 | Val Loss=3.0336, C-idx=0.7688
Epoch  21: Train Loss=2.9297 | Val Loss=2.9857, C-idx=0.7782
Epoch  22: Train Loss=2.8837 | Val Loss=2.9375, C-idx=0.7861
Epoch  23: Train Loss=2.8448 | Val Loss=2.9427, C-idx=0.7841
Epoch  24: Train Loss=2.8718 | Val Loss=2.9294, C-idx=0.7895
  ✓ New best validation C-index: 0.7895
Epoch  25: Train Loss=2.8145 | Val Loss=2.9683, C-idx=0.7855
Epoch  26: Train Loss=2.8071 | Val Loss=2.9354, C-idx=0.7790
Epoch  27: Train Loss=2.7491 | Val Loss=2.9329, C-idx=0.7809
Epoch  28: Train Loss=2.7983 | Val Loss=2.8955, C-idx=0.7808
Epoch  29: Train Loss=2.7944 | Val Loss=2.9310, C-idx=0.7807
Epoch  30: Train Loss=2.7433 | Val Loss=2.9364, C-idx=0.7773
Epoch  31: Train Loss=2.7103 | Val Loss=2.9216, C-idx=0.7787
Epoch  32: Train Loss=2.7141 | Val Loss=2.9705, C-idx=0.7701
Epoch  33: Train Loss=2.6948 | Val Loss=2.9603, C-idx=0.7746
Epoch  34: Train Loss=2.6690 | Val Loss=2.9855, C-idx=0.7675

Early stopping at epoch 34

================================================================================
RESULTS: v3_wider
================================================================================
Best Val C-index:  0.7895
Test C-index:      0.7461
Test Loss:         2.9715

################################################################################
# Configuration 4/8
################################################################################

================================================================================
Training: v4_very_wide
================================================================================
Config: {
  "name": "v4_very_wide",
  "embedding_dim": 320,
  "n_layers": 4,
  "n_heads": 8,
  "dropout": 0.5,
  "learning_rate": 0.0002,
  "weight_decay": 0.001
}

Model parameters: 3,727,049
Epoch   1: Train Loss=3.7959 | Val Loss=3.2956, C-idx=0.6917
  ✓ New best validation C-index: 0.6917
Epoch   2: Train Loss=3.4448 | Val Loss=3.2392, C-idx=0.6855
Epoch   3: Train Loss=3.3115 | Val Loss=3.2313, C-idx=0.6801
Epoch   4: Train Loss=3.2154 | Val Loss=3.1589, C-idx=0.7314
  ✓ New best validation C-index: 0.7314
Epoch   5: Train Loss=3.1934 | Val Loss=3.1479, C-idx=0.7449
  ✓ New best validation C-index: 0.7449
Epoch   6: Train Loss=3.1644 | Val Loss=3.1127, C-idx=0.7469
  ✓ New best validation C-index: 0.7469
Epoch   7: Train Loss=3.1261 | Val Loss=3.1043, C-idx=0.7555
  ✓ New best validation C-index: 0.7555
Epoch   8: Train Loss=3.0916 | Val Loss=3.0692, C-idx=0.7603
  ✓ New best validation C-index: 0.7603
Epoch   9: Train Loss=3.0808 | Val Loss=3.0682, C-idx=0.7686
  ✓ New best validation C-index: 0.7686
Epoch  10: Train Loss=3.0683 | Val Loss=3.0782, C-idx=0.7609
Epoch  11: Train Loss=3.0647 | Val Loss=3.0700, C-idx=0.7682
Epoch  12: Train Loss=3.0632 | Val Loss=3.0296, C-idx=0.7657
Epoch  13: Train Loss=3.0458 | Val Loss=3.0236, C-idx=0.7716
  ✓ New best validation C-index: 0.7716
Epoch  14: Train Loss=3.0506 | Val Loss=3.0576, C-idx=0.7757
  ✓ New best validation C-index: 0.7757
Epoch  15: Train Loss=3.0225 | Val Loss=3.0525, C-idx=0.7681
Epoch  16: Train Loss=2.9992 | Val Loss=3.0765, C-idx=0.7715
Epoch  17: Train Loss=2.9995 | Val Loss=3.1219, C-idx=0.7609
Epoch  18: Train Loss=2.9766 | Val Loss=2.9972, C-idx=0.7753
Epoch  19: Train Loss=2.9870 | Val Loss=3.0263, C-idx=0.7713
Epoch  20: Train Loss=2.9918 | Val Loss=3.0046, C-idx=0.7751
Epoch  21: Train Loss=2.9503 | Val Loss=2.9991, C-idx=0.7777
  ✓ New best validation C-index: 0.7777
Epoch  22: Train Loss=2.9633 | Val Loss=3.0028, C-idx=0.7764
Epoch  23: Train Loss=2.9211 | Val Loss=3.0179, C-idx=0.7747
Epoch  24: Train Loss=2.8938 | Val Loss=3.0244, C-idx=0.7732
Epoch  25: Train Loss=2.9217 | Val Loss=3.0336, C-idx=0.7711
Epoch  26: Train Loss=2.9073 | Val Loss=3.0006, C-idx=0.7746
Epoch  27: Train Loss=2.8941 | Val Loss=2.9917, C-idx=0.7773
Epoch  28: Train Loss=2.8930 | Val Loss=2.9892, C-idx=0.7782
  ✓ New best validation C-index: 0.7782
Epoch  29: Train Loss=2.8558 | Val Loss=2.9974, C-idx=0.7758
Epoch  30: Train Loss=2.8755 | Val Loss=3.0049, C-idx=0.7776
Epoch  31: Train Loss=2.8631 | Val Loss=3.0063, C-idx=0.7776
Epoch  32: Train Loss=2.8456 | Val Loss=3.0336, C-idx=0.7771
Epoch  33: Train Loss=2.8617 | Val Loss=3.0361, C-idx=0.7766
Epoch  34: Train Loss=2.8479 | Val Loss=3.0311, C-idx=0.7797
  ✓ New best validation C-index: 0.7797
Epoch  35: Train Loss=2.8311 | Val Loss=2.9893, C-idx=0.7823
  ✓ New best validation C-index: 0.7823
Epoch  36: Train Loss=2.8387 | Val Loss=3.0376, C-idx=0.7802
Epoch  37: Train Loss=2.8211 | Val Loss=3.0059, C-idx=0.7823
  ✓ New best validation C-index: 0.7823
Epoch  38: Train Loss=2.7945 | Val Loss=3.0286, C-idx=0.7816
Epoch  39: Train Loss=2.7736 | Val Loss=3.0187, C-idx=0.7779
Epoch  40: Train Loss=2.8071 | Val Loss=3.0123, C-idx=0.7821
Epoch  41: Train Loss=2.7915 | Val Loss=3.0838, C-idx=0.7646
Epoch  42: Train Loss=2.7557 | Val Loss=3.0804, C-idx=0.7686
Epoch  43: Train Loss=2.7527 | Val Loss=3.0518, C-idx=0.7742
Epoch  44: Train Loss=2.7516 | Val Loss=3.0546, C-idx=0.7731
Epoch  45: Train Loss=2.7284 | Val Loss=3.0917, C-idx=0.7715
Epoch  46: Train Loss=2.7300 | Val Loss=3.0902, C-idx=0.7708
Epoch  47: Train Loss=2.7466 | Val Loss=3.1032, C-idx=0.7654

Early stopping at epoch 47

================================================================================
RESULTS: v4_very_wide
================================================================================
Best Val C-index:  0.7823
Test C-index:      0.7521
Test Loss:         2.9811

################################################################################
# Configuration 5/8
################################################################################

================================================================================
Training: v5_heavy_reg
================================================================================
Config: {
  "name": "v5_heavy_reg",
  "embedding_dim": 160,
  "n_layers": 5,
  "n_heads": 8,
  "dropout": 0.6,
  "learning_rate": 0.0003,
  "weight_decay": 0.001
}

Model parameters: 1,674,889
Epoch   1: Train Loss=3.9788 | Val Loss=3.3548, C-idx=0.6088
  ✓ New best validation C-index: 0.6088
Epoch   2: Train Loss=3.5007 | Val Loss=3.3573, C-idx=0.5777
Epoch   3: Train Loss=3.4100 | Val Loss=3.3563, C-idx=0.6446
  ✓ New best validation C-index: 0.6446
Epoch   4: Train Loss=3.3692 | Val Loss=3.3574, C-idx=0.5735
Epoch   5: Train Loss=3.3740 | Val Loss=3.3577, C-idx=0.4881
Epoch   6: Train Loss=3.3776 | Val Loss=3.3575, C-idx=0.5571
Epoch   7: Train Loss=3.3624 | Val Loss=3.3536, C-idx=0.6822
  ✓ New best validation C-index: 0.6822
Epoch   8: Train Loss=3.3362 | Val Loss=3.2904, C-idx=0.6790
Epoch   9: Train Loss=3.2877 | Val Loss=3.2254, C-idx=0.6889
  ✓ New best validation C-index: 0.6889
Epoch  10: Train Loss=3.2394 | Val Loss=3.1882, C-idx=0.6956
  ✓ New best validation C-index: 0.6956
Epoch  11: Train Loss=3.2338 | Val Loss=3.2102, C-idx=0.6943
Epoch  12: Train Loss=3.1958 | Val Loss=3.2077, C-idx=0.7113
  ✓ New best validation C-index: 0.7113
Epoch  13: Train Loss=3.2158 | Val Loss=3.1438, C-idx=0.7327
  ✓ New best validation C-index: 0.7327
Epoch  14: Train Loss=3.1821 | Val Loss=3.1507, C-idx=0.7348
  ✓ New best validation C-index: 0.7348
Epoch  15: Train Loss=3.1815 | Val Loss=3.1357, C-idx=0.7457
  ✓ New best validation C-index: 0.7457
Epoch  16: Train Loss=3.1648 | Val Loss=3.1156, C-idx=0.7523
  ✓ New best validation C-index: 0.7523
Epoch  17: Train Loss=3.1403 | Val Loss=3.1324, C-idx=0.7527
  ✓ New best validation C-index: 0.7527
Epoch  18: Train Loss=3.1419 | Val Loss=3.1453, C-idx=0.7539
  ✓ New best validation C-index: 0.7539
Epoch  19: Train Loss=3.1377 | Val Loss=3.0720, C-idx=0.7729
  ✓ New best validation C-index: 0.7729
Epoch  20: Train Loss=3.1476 | Val Loss=3.1096, C-idx=0.7608
Epoch  21: Train Loss=3.1361 | Val Loss=3.1163, C-idx=0.7597
Epoch  22: Train Loss=3.1167 | Val Loss=3.0851, C-idx=0.7624
Epoch  23: Train Loss=3.0794 | Val Loss=3.0841, C-idx=0.7646
Epoch  24: Train Loss=3.1092 | Val Loss=3.0731, C-idx=0.7667
Epoch  25: Train Loss=3.0611 | Val Loss=3.0608, C-idx=0.7635
Epoch  26: Train Loss=3.1265 | Val Loss=3.0752, C-idx=0.7700
Epoch  27: Train Loss=3.0684 | Val Loss=3.0688, C-idx=0.7686
Epoch  28: Train Loss=3.0807 | Val Loss=3.0686, C-idx=0.7713
Epoch  29: Train Loss=3.0871 | Val Loss=3.0453, C-idx=0.7732
  ✓ New best validation C-index: 0.7732
Epoch  30: Train Loss=3.0633 | Val Loss=3.0397, C-idx=0.7681
Epoch  31: Train Loss=3.0608 | Val Loss=3.0301, C-idx=0.7750
  ✓ New best validation C-index: 0.7750
Epoch  32: Train Loss=3.0425 | Val Loss=3.0394, C-idx=0.7734
Epoch  33: Train Loss=3.0204 | Val Loss=2.9970, C-idx=0.7791
  ✓ New best validation C-index: 0.7791
Epoch  34: Train Loss=2.9874 | Val Loss=3.0045, C-idx=0.7785
Epoch  35: Train Loss=3.0197 | Val Loss=3.0106, C-idx=0.7861
  ✓ New best validation C-index: 0.7861
Epoch  36: Train Loss=3.0189 | Val Loss=3.0236, C-idx=0.7736
Epoch  37: Train Loss=2.9749 | Val Loss=2.9898, C-idx=0.7756
Epoch  38: Train Loss=2.9822 | Val Loss=3.0354, C-idx=0.7700
Epoch  39: Train Loss=2.9621 | Val Loss=3.0323, C-idx=0.7748
Epoch  40: Train Loss=2.9685 | Val Loss=3.0809, C-idx=0.7704
Epoch  41: Train Loss=2.9582 | Val Loss=3.0116, C-idx=0.7813
Epoch  42: Train Loss=2.9206 | Val Loss=3.0279, C-idx=0.7778
Epoch  43: Train Loss=2.9200 | Val Loss=3.0078, C-idx=0.7827
Epoch  44: Train Loss=2.9081 | Val Loss=3.0611, C-idx=0.7773
Epoch  45: Train Loss=2.9345 | Val Loss=3.0805, C-idx=0.7700

Early stopping at epoch 45

================================================================================
RESULTS: v5_heavy_reg
================================================================================
Best Val C-index:  0.7861
Test C-index:      0.7512
Test Loss:         3.0098

################################################################################
# Configuration 6/8
################################################################################

================================================================================
Training: v6_more_heads
================================================================================
Config: {
  "name": "v6_more_heads",
  "embedding_dim": 192,
  "n_layers": 5,
  "n_heads": 12,
  "dropout": 0.45,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

Model parameters: 2,153,613
Epoch   1: Train Loss=3.5918 | Val Loss=3.3324, C-idx=0.6676
  ✓ New best validation C-index: 0.6676
Epoch   2: Train Loss=3.3484 | Val Loss=3.1895, C-idx=0.7153
  ✓ New best validation C-index: 0.7153
Epoch   3: Train Loss=3.2208 | Val Loss=3.1376, C-idx=0.7373
  ✓ New best validation C-index: 0.7373
Epoch   4: Train Loss=3.2156 | Val Loss=3.1360, C-idx=0.7394
  ✓ New best validation C-index: 0.7394
Epoch   5: Train Loss=3.1562 | Val Loss=3.0837, C-idx=0.7543
  ✓ New best validation C-index: 0.7543
Epoch   6: Train Loss=3.1455 | Val Loss=3.1178, C-idx=0.7530
Epoch   7: Train Loss=3.1180 | Val Loss=3.1107, C-idx=0.7618
  ✓ New best validation C-index: 0.7618
Epoch   8: Train Loss=3.1042 | Val Loss=3.0390, C-idx=0.7673
  ✓ New best validation C-index: 0.7673
Epoch   9: Train Loss=3.0288 | Val Loss=3.0402, C-idx=0.7710
  ✓ New best validation C-index: 0.7710
Epoch  10: Train Loss=3.0634 | Val Loss=3.0386, C-idx=0.7736
  ✓ New best validation C-index: 0.7736
Epoch  11: Train Loss=3.0207 | Val Loss=3.0175, C-idx=0.7706
Epoch  12: Train Loss=3.0069 | Val Loss=3.0243, C-idx=0.7690
Epoch  13: Train Loss=2.9730 | Val Loss=3.0955, C-idx=0.7592
Epoch  14: Train Loss=2.9564 | Val Loss=2.9292, C-idx=0.7902
  ✓ New best validation C-index: 0.7902
Epoch  15: Train Loss=2.9527 | Val Loss=2.9904, C-idx=0.7763
Epoch  16: Train Loss=2.9238 | Val Loss=3.0050, C-idx=0.7784
Epoch  17: Train Loss=2.9181 | Val Loss=2.9849, C-idx=0.7856
Epoch  18: Train Loss=2.9218 | Val Loss=3.0421, C-idx=0.7792
Epoch  19: Train Loss=2.8718 | Val Loss=3.0551, C-idx=0.7716
Epoch  20: Train Loss=2.8718 | Val Loss=3.0367, C-idx=0.7745
Epoch  21: Train Loss=2.8256 | Val Loss=3.0704, C-idx=0.7784
Epoch  22: Train Loss=2.7891 | Val Loss=3.0650, C-idx=0.7825
Epoch  23: Train Loss=2.7919 | Val Loss=3.0611, C-idx=0.7801
Epoch  24: Train Loss=2.7904 | Val Loss=3.0583, C-idx=0.7761

Early stopping at epoch 24

================================================================================
RESULTS: v6_more_heads
================================================================================
Best Val C-index:  0.7902
Test C-index:      0.7569
Test Loss:         2.9367

################################################################################
# Configuration 7/8
################################################################################

================================================================================
Training: v7_shallow_wide
================================================================================
Config: {
  "name": "v7_shallow_wide",
  "embedding_dim": 256,
  "n_layers": 3,
  "n_heads": 8,
  "dropout": 0.4,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

Model parameters: 2,069,897
Epoch   1: Train Loss=3.4574 | Val Loss=3.2173, C-idx=0.6930
  ✓ New best validation C-index: 0.6930
Epoch   2: Train Loss=3.2662 | Val Loss=3.1335, C-idx=0.7290
  ✓ New best validation C-index: 0.7290
Epoch   3: Train Loss=3.1963 | Val Loss=3.0666, C-idx=0.7561
  ✓ New best validation C-index: 0.7561
Epoch   4: Train Loss=3.1681 | Val Loss=3.1083, C-idx=0.7407
Epoch   5: Train Loss=3.0900 | Val Loss=3.0739, C-idx=0.7652
  ✓ New best validation C-index: 0.7652
Epoch   6: Train Loss=3.1064 | Val Loss=3.0713, C-idx=0.7705
  ✓ New best validation C-index: 0.7705
Epoch   7: Train Loss=3.1130 | Val Loss=3.0930, C-idx=0.7611
Epoch   8: Train Loss=3.0744 | Val Loss=3.0651, C-idx=0.7654
Epoch   9: Train Loss=3.0229 | Val Loss=3.0234, C-idx=0.7630
Epoch  10: Train Loss=3.0262 | Val Loss=3.0839, C-idx=0.7690
Epoch  11: Train Loss=3.0178 | Val Loss=3.0181, C-idx=0.7824
  ✓ New best validation C-index: 0.7824
Epoch  12: Train Loss=3.0166 | Val Loss=2.9781, C-idx=0.7882
  ✓ New best validation C-index: 0.7882
Epoch  13: Train Loss=2.9844 | Val Loss=3.0300, C-idx=0.7654
Epoch  14: Train Loss=2.9982 | Val Loss=3.0253, C-idx=0.7801
Epoch  15: Train Loss=2.9545 | Val Loss=3.0186, C-idx=0.7842
Epoch  16: Train Loss=2.9405 | Val Loss=3.0213, C-idx=0.7930
  ✓ New best validation C-index: 0.7930
Epoch  17: Train Loss=2.9194 | Val Loss=2.9784, C-idx=0.7920
Epoch  18: Train Loss=2.9075 | Val Loss=3.0433, C-idx=0.7888
Epoch  19: Train Loss=2.9192 | Val Loss=2.9961, C-idx=0.7972
  ✓ New best validation C-index: 0.7972
Epoch  20: Train Loss=2.9373 | Val Loss=2.9882, C-idx=0.7933
Epoch  21: Train Loss=2.8681 | Val Loss=2.9935, C-idx=0.7938
Epoch  22: Train Loss=2.9003 | Val Loss=2.9201, C-idx=0.8066
  ✓ New best validation C-index: 0.8066
Epoch  23: Train Loss=2.8595 | Val Loss=2.9533, C-idx=0.8076
  ✓ New best validation C-index: 0.8076
Epoch  24: Train Loss=2.8468 | Val Loss=2.9310, C-idx=0.8016
Epoch  25: Train Loss=2.8280 | Val Loss=2.9053, C-idx=0.8123
  ✓ New best validation C-index: 0.8123
Epoch  26: Train Loss=2.8268 | Val Loss=2.8802, C-idx=0.7996
Epoch  27: Train Loss=2.8242 | Val Loss=2.8780, C-idx=0.8087
Epoch  28: Train Loss=2.7631 | Val Loss=2.9977, C-idx=0.7952
Epoch  29: Train Loss=2.7925 | Val Loss=2.9294, C-idx=0.8022
Epoch  30: Train Loss=2.7608 | Val Loss=2.9644, C-idx=0.8001
Epoch  31: Train Loss=2.7417 | Val Loss=2.9261, C-idx=0.7941
Epoch  32: Train Loss=2.7056 | Val Loss=2.9013, C-idx=0.8003
Epoch  33: Train Loss=2.6960 | Val Loss=2.9049, C-idx=0.8031
Epoch  34: Train Loss=2.6805 | Val Loss=2.9284, C-idx=0.8007
Epoch  35: Train Loss=2.6823 | Val Loss=2.8949, C-idx=0.8032

Early stopping at epoch 35

================================================================================
RESULTS: v7_shallow_wide
================================================================================
Best Val C-index:  0.8123
Test C-index:      0.7798
Test Loss:         2.8218

################################################################################
# Configuration 8/8
################################################################################

================================================================================
Training: v8_compact
================================================================================
Config: {
  "name": "v8_compact",
  "embedding_dim": 96,
  "n_layers": 6,
  "n_heads": 6,
  "dropout": 0.45,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

Model parameters: 1,023,079
Epoch   1: Train Loss=3.5425 | Val Loss=3.3081, C-idx=0.6698
  ✓ New best validation C-index: 0.6698
Epoch   2: Train Loss=3.4029 | Val Loss=3.2665, C-idx=0.6795
  ✓ New best validation C-index: 0.6795
Epoch   3: Train Loss=3.2977 | Val Loss=3.2078, C-idx=0.6861
  ✓ New best validation C-index: 0.6861
Epoch   4: Train Loss=3.2534 | Val Loss=3.2056, C-idx=0.6931
  ✓ New best validation C-index: 0.6931
Epoch   5: Train Loss=3.2213 | Val Loss=3.1769, C-idx=0.7055
  ✓ New best validation C-index: 0.7055
Epoch   6: Train Loss=3.2146 | Val Loss=3.1297, C-idx=0.7161
  ✓ New best validation C-index: 0.7161
Epoch   7: Train Loss=3.1844 | Val Loss=3.1267, C-idx=0.7300
  ✓ New best validation C-index: 0.7300
Epoch   8: Train Loss=3.1587 | Val Loss=3.0964, C-idx=0.7482
  ✓ New best validation C-index: 0.7482
Epoch   9: Train Loss=3.1409 | Val Loss=3.0925, C-idx=0.7580
  ✓ New best validation C-index: 0.7580
Epoch  10: Train Loss=3.0991 | Val Loss=3.0788, C-idx=0.7602
  ✓ New best validation C-index: 0.7602
Epoch  11: Train Loss=3.0583 | Val Loss=3.0930, C-idx=0.7607
  ✓ New best validation C-index: 0.7607
Epoch  12: Train Loss=3.0585 | Val Loss=3.1099, C-idx=0.7581
Epoch  13: Train Loss=3.0357 | Val Loss=3.0655, C-idx=0.7649
  ✓ New best validation C-index: 0.7649
Epoch  14: Train Loss=2.9883 | Val Loss=3.0323, C-idx=0.7746
  ✓ New best validation C-index: 0.7746
Epoch  15: Train Loss=3.0018 | Val Loss=3.0960, C-idx=0.7525
Epoch  16: Train Loss=3.0016 | Val Loss=3.0584, C-idx=0.7668
Epoch  17: Train Loss=2.9395 | Val Loss=3.1015, C-idx=0.7552
Epoch  18: Train Loss=2.9247 | Val Loss=3.1434, C-idx=0.7436
Epoch  19: Train Loss=2.8995 | Val Loss=3.1007, C-idx=0.7660
Epoch  20: Train Loss=2.8955 | Val Loss=3.1563, C-idx=0.7483
Epoch  21: Train Loss=2.8390 | Val Loss=3.1255, C-idx=0.7540
Epoch  22: Train Loss=2.8279 | Val Loss=3.2188, C-idx=0.7472
Epoch  23: Train Loss=2.8195 | Val Loss=3.1332, C-idx=0.7605
Epoch  24: Train Loss=2.7910 | Val Loss=3.1179, C-idx=0.7587

Early stopping at epoch 24

================================================================================
RESULTS: v8_compact
================================================================================
Best Val C-index:  0.7746
Test C-index:      0.7055
Test Loss:         3.1191

================================================================================
OPTIMIZATION COMPLETE
================================================================================
End time: 2025-12-03 10:38:22

Tested 8 configurations successfully

================================================================================
BEST MODEL
================================================================================
Name: v7_shallow_wide
Test C-index: 0.7798
Val C-index: 0.8123
Parameters: 2,069,897

Configuration:
{
  "name": "v7_shallow_wide",
  "embedding_dim": 256,
  "n_layers": 3,
  "n_heads": 8,
  "dropout": 0.4,
  "learning_rate": 0.0003,
  "weight_decay": 0.0005
}

================================================================================
ALL RESULTS (Ranked by Test C-index)
================================================================================
Rank   Name                        Test C-idx    Val C-idx     Params
--------------------------------------------------------------------------------
1      v7_shallow_wide                 0.7798       0.8123  2,069,897
2      v6_more_heads                   0.7569       0.7902  2,153,613
3      v4_very_wide                    0.7521       0.7823  3,727,049
4      v5_heavy_reg                    0.7512       0.7861  1,674,889
5      v3_wider                        0.7461       0.7895  2,662,665
6      v1_baseline                     0.7367       0.7830  1,674,889
7      v2_deeper                       0.7292       0.7580  1,937,801
8      v8_compact                      0.7055       0.7746  1,023,079

✅ Saved summary to: outputs/optimization/optimization_summary.json
✅ Best model saved to: outputs/optimization/v7_shallow_wide_best.pt
