Logging to: outputs/logs_20251201_213026.txt
================================================================================
Graph Transformer Cancer Type Classifier
================================================================================

Device: cpu
Output directory: outputs

================================================================================
Loading Graph Prior
================================================================================
Loaded STRING prior: 198 proteins, 1184 edges
Computed diffusion kernel and 16 positional encodings

================================================================================
Loading and Preprocessing Data
================================================================================
Loading data from /Users/andykim/Documents/2025 Fall/SMG/Project/SMG_Final_Project/processed_datasets/tcga_pancan_rppa_compiled.csv...
Loaded 7523 samples
Found 198 protein columns in CSV
Filtering samples: 7523/7523 have ≤50.0% missing values
After filtering: 7523 samples across 32 cancer types
Cancer type distribution:
CANCER_TYPE_ACRONYM
ACC      45
BLCA    343
BRCA    876
CESC    166
CHOL     30
COAD    346
DLBC     33
ESCA    125
GBM     231
HNSC    211
KICH     62
KIRC    455
KIRP    209
LGG     428
LIHC    179
LUAD    360
LUSC    317
MESO     63
OV      414
PAAD    122
PCPG     79
PRAD    350
READ    118
SARC    218
SKCM    329
STAD    354
TGCT    118
THCA    369
THYM     90
UCEC    423
UCS      48
UVM      12
Name: count, dtype: int64

Data splits:
  Train: 6395 samples (85.0%)
  Val:   751 samples (10.0%)
  Test:  377 samples (5.0%)

Handling missing values...
  train: 38694 missing values, imputing with train means
  val: 4503 missing values, imputing with train means
  test: 2256 missing values, imputing with train means

Standardizing protein features...
  Mean: [-0.72304177  0.3114389   0.21158511  0.79045542  1.54661482] ... (first 5)
  Std:  [0.27367524 0.55451515 0.34961754 0.76169914 0.6686727 ] ... (first 5)

Creating DataLoaders...

================================================================================
Initializing Model
================================================================================
Model parameters: 831,592
Number of proteins: 198
Number of classes: 32
Classes: ['ACC', 'BLCA', 'BRCA', 'CESC', 'CHOL', 'COAD', 'DLBC', 'ESCA', 'GBM', 'HNSC', 'KICH', 'KIRC', 'KIRP', 'LGG', 'LIHC', 'LUAD', 'LUSC', 'MESO', 'OV', 'PAAD', 'PCPG', 'PRAD', 'READ', 'SARC', 'SKCM', 'STAD', 'TGCT', 'THCA', 'THYM', 'UCEC', 'UCS', 'UVM']

================================================================================
Training
================================================================================

Epoch 1/100
--------------------------------------------------------------------------------

Train Loss: 3.2868 | Train Acc: 0.0899
Val Loss:   3.0622 | Val Acc:   0.1411 | F1 (macro): 0.0488
✓ Saved best model (val_loss: 3.0622)

Epoch 2/100
--------------------------------------------------------------------------------

Train Loss: 2.7580 | Train Acc: 0.2421
Val Loss:   2.2702 | Val Acc:   0.3702 | F1 (macro): 0.1913
✓ Saved best model (val_loss: 2.2702)

Epoch 3/100
--------------------------------------------------------------------------------

Train Loss: 2.1846 | Train Acc: 0.4041
Val Loss:   1.8795 | Val Acc:   0.4727 | F1 (macro): 0.2808
✓ Saved best model (val_loss: 1.8795)

Epoch 4/100
--------------------------------------------------------------------------------

Train Loss: 1.8159 | Train Acc: 0.5009
Val Loss:   1.6776 | Val Acc:   0.5459 | F1 (macro): 0.3610
✓ Saved best model (val_loss: 1.6776)

Epoch 5/100
--------------------------------------------------------------------------------

Train Loss: 1.5794 | Train Acc: 0.5604
Val Loss:   1.5629 | Val Acc:   0.5513 | F1 (macro): 0.3837
✓ Saved best model (val_loss: 1.5629)

Epoch 6/100
--------------------------------------------------------------------------------

Train Loss: 1.3650 | Train Acc: 0.6125
Val Loss:   1.2822 | Val Acc:   0.6338 | F1 (macro): 0.4744
✓ Saved best model (val_loss: 1.2822)

Epoch 7/100
--------------------------------------------------------------------------------

Train Loss: 1.2078 | Train Acc: 0.6557
Val Loss:   1.1047 | Val Acc:   0.6751 | F1 (macro): 0.5278
✓ Saved best model (val_loss: 1.1047)

Epoch 8/100
--------------------------------------------------------------------------------

Train Loss: 1.1149 | Train Acc: 0.6779
Val Loss:   1.0172 | Val Acc:   0.7084 | F1 (macro): 0.5570
✓ Saved best model (val_loss: 1.0172)

Epoch 9/100
--------------------------------------------------------------------------------

Train Loss: 1.0010 | Train Acc: 0.7110
Val Loss:   1.0689 | Val Acc:   0.6897 | F1 (macro): 0.5540

Epoch 10/100
--------------------------------------------------------------------------------

Train Loss: 0.9103 | Train Acc: 0.7351
Val Loss:   0.9021 | Val Acc:   0.7470 | F1 (macro): 0.5987
✓ Saved best model (val_loss: 0.9021)

Epoch 11/100
--------------------------------------------------------------------------------

Train Loss: 0.8587 | Train Acc: 0.7498
Val Loss:   0.8729 | Val Acc:   0.7497 | F1 (macro): 0.6121
✓ Saved best model (val_loss: 0.8729)

Epoch 12/100
--------------------------------------------------------------------------------

Train Loss: 0.7826 | Train Acc: 0.7683
Val Loss:   0.7641 | Val Acc:   0.7736 | F1 (macro): 0.6487
✓ Saved best model (val_loss: 0.7641)

Epoch 13/100
--------------------------------------------------------------------------------

Train Loss: 0.7284 | Train Acc: 0.7891
Val Loss:   0.7606 | Val Acc:   0.7643 | F1 (macro): 0.6252
✓ Saved best model (val_loss: 0.7606)

Epoch 14/100
--------------------------------------------------------------------------------

Train Loss: 0.6898 | Train Acc: 0.7952
Val Loss:   0.7352 | Val Acc:   0.7656 | F1 (macro): 0.6250
✓ Saved best model (val_loss: 0.7352)

Epoch 15/100
--------------------------------------------------------------------------------

Train Loss: 0.6326 | Train Acc: 0.8170
Val Loss:   0.8145 | Val Acc:   0.7563 | F1 (macro): 0.6239

Epoch 16/100
--------------------------------------------------------------------------------

Train Loss: 0.6096 | Train Acc: 0.8159
Val Loss:   0.6489 | Val Acc:   0.8003 | F1 (macro): 0.6770
✓ Saved best model (val_loss: 0.6489)

Epoch 17/100
--------------------------------------------------------------------------------

Train Loss: 0.5531 | Train Acc: 0.8360
Val Loss:   0.6098 | Val Acc:   0.8269 | F1 (macro): 0.7269
✓ Saved best model (val_loss: 0.6098)

Epoch 18/100
--------------------------------------------------------------------------------

Train Loss: 0.5335 | Train Acc: 0.8435
Val Loss:   0.6043 | Val Acc:   0.8149 | F1 (macro): 0.6997
✓ Saved best model (val_loss: 0.6043)

Epoch 19/100
--------------------------------------------------------------------------------

Train Loss: 0.5024 | Train Acc: 0.8516
Val Loss:   0.6234 | Val Acc:   0.8043 | F1 (macro): 0.7052

Epoch 20/100
--------------------------------------------------------------------------------

Train Loss: 0.4761 | Train Acc: 0.8593
Val Loss:   0.5681 | Val Acc:   0.8375 | F1 (macro): 0.7453
✓ Saved best model (val_loss: 0.5681)

Epoch 21/100
--------------------------------------------------------------------------------

Train Loss: 0.4639 | Train Acc: 0.8571
Val Loss:   0.5589 | Val Acc:   0.8202 | F1 (macro): 0.7141
✓ Saved best model (val_loss: 0.5589)

Epoch 22/100
--------------------------------------------------------------------------------

Train Loss: 0.4258 | Train Acc: 0.8702
Val Loss:   0.5977 | Val Acc:   0.8269 | F1 (macro): 0.7412

Epoch 23/100
--------------------------------------------------------------------------------

Train Loss: 0.4036 | Train Acc: 0.8715
Val Loss:   0.5508 | Val Acc:   0.8362 | F1 (macro): 0.7324
✓ Saved best model (val_loss: 0.5508)

Epoch 24/100
--------------------------------------------------------------------------------

Train Loss: 0.3827 | Train Acc: 0.8805
Val Loss:   0.5439 | Val Acc:   0.8375 | F1 (macro): 0.7387
✓ Saved best model (val_loss: 0.5439)

Epoch 25/100
--------------------------------------------------------------------------------

Train Loss: 0.3494 | Train Acc: 0.8891
Val Loss:   0.5183 | Val Acc:   0.8442 | F1 (macro): 0.7537
✓ Saved best model (val_loss: 0.5183)

Epoch 26/100
--------------------------------------------------------------------------------

Train Loss: 0.3380 | Train Acc: 0.8976
Val Loss:   0.4842 | Val Acc:   0.8522 | F1 (macro): 0.7464
✓ Saved best model (val_loss: 0.4842)

Epoch 27/100
--------------------------------------------------------------------------------

Train Loss: 0.3358 | Train Acc: 0.8935
Val Loss:   0.5792 | Val Acc:   0.8322 | F1 (macro): 0.7238

Epoch 28/100
--------------------------------------------------------------------------------
